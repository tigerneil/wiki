<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">ERC-721: NFT | Gear documentation portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wiki.gear-tech.io//developing-contracts/examples/erc-721"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ERC-721: NFT | Gear documentation portal"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><link data-react-helmet="true" rel="icon" href="/img/favicon-32x32.png"><link data-react-helmet="true" rel="canonical" href="https://wiki.gear-tech.io//developing-contracts/examples/erc-721"><link data-react-helmet="true" rel="alternate" href="https://wiki.gear-tech.io//developing-contracts/examples/erc-721" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wiki.gear-tech.io//zh-cn/developing-contracts/examples/erc-721" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://wiki.gear-tech.io//developing-contracts/examples/erc-721" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fb4df1ba.css">
<link rel="preload" href="/assets/js/runtime~main.104e92f9.js" as="script">
<link rel="preload" href="/assets/js/main.01f51f45.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-black.svg" alt="Gear documentation portal" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-white.svg" alt="Gear documentation portal" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Gear Wiki</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gear-tech/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/developing-contracts/examples/erc-721" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-cn/developing-contracts/examples/erc-721" target="_self" rel="noopener noreferrer" class="dropdown__link">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/gear/glossary">Intro to Gear</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/ecosystem/polkadot">Ecosystem</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/getting-started-in-5-minutes">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/idea/idea-overview">Gear IDEA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/node/setting-up">Gear Node</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/developing-contracts/cargo-program">Developing Smart Contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/cargo-program">Cargo-program Utility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/gear-program">Program State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/messaging">Message Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/testing">Program testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/deploy">Upload Program</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/send-a-transaction">Send a Message</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/developing-contracts/examples/prerequisites">Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/examples/prerequisites">Prerequisites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/examples/ping">PING-PONG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/developing-contracts/examples/erc-721">ERC-721: NFT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/examples/erc20">ERC-20</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/examples/DAO">DAO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developing-contracts/examples/feeds">Gear Feeds</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/api/connect">API for interacting with node</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/general/web3">General topics</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ERC-721: NFT</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">â€‹</a></h2><p>At Gear, we want to provide an ecosystem for developers coming from various backgrounds. We have to note that Gear offers far more advanced features and technological developments compared to platforms that popular protocols like ERC-20 or ERC-721 were designed for. However, it would be inefficient to ignore such widely used interfaces in favor of arbitrary, but modern implementations. Therefore, Gear provides support for ERC-721 based NFT tokens, as well as an updated standard based on Gear&#x27;s vision.</p><p>In this article, we will cover usage of Gear&#x27;s ERC-721 interface library in composition with an example NFT implementation.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="erc-721-interface">ERC-721 interface<a class="hash-link" href="#erc-721-interface" title="Direct link to heading">â€‹</a></h2><p>ERC-721 protocol is a community-accepted standard for Non-Fungible Tokens (NFTs) smart contract implementation. In this article, we will go over the details of how to use the ERC-721 interface provided by Gear via an example.</p><p><a href="https://eips.ethereum.org/EIPS/eip-721" target="_blank" rel="noopener noreferrer">ERC-721</a> describes the interface that has to be implemented by a smart contract in order to be compliant. The following functions are expected to be present in the NFT contract:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// This emits when ownership of any NFT changes by any mechanism.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Transfer(from, to, tokenId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// This emits when the approved address for an NFT is changed or reaffirmed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ApprovalForAll(_owner, operator, approved);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Count all NFTs assigned to an owner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">balanceOf(owner): integer;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Find the owner of an NFT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ownerOf(tokenId): address;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Transfers the ownership of an NFT from one address to another address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">safeTransferFrom(from, to, tokenId, data: optional);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Transfer ownership of an NFT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">transferFrom(from, to, tokenId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Change or reaffirm the approved address for an NFT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">approve(approved, tokenId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Enable or disable approval for a third party (&quot;operator&quot;) to manage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setApprovalForAll(operator, approved);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Get the approved address for a single NFT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">getApproved(tokenId): address;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// @notice Query if an address is an authorized operator for another address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">isApprovedForAll(owner, operator): bool;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>However, implicitly, some functions - like <code>mint</code> and <code>burn</code> - are expected to be implemented in the contract as well. Implementation for those functions may vary, therefore leading to existence various NFT collections.</p><p>Gear provides an <a href="https://github.com/gear-tech/apps/tree/master/non-fungible-token" target="_blank" rel="noopener noreferrer">ERC-721 interface library</a> with shared functionality described in the protocol.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Please note that the interface does <strong>not</strong> yet support features like <code>ERC721TokenReceiver</code> and <code>SafeTransferFrom</code>. However, those will be added as soon as possible.</p></div></div><p>The NonFungibleToken interface introduces the <code>NonFungibleTokenBase</code> trait that contains the following function signatures:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// called during the NFT contract deployment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fn init(&amp;mut self, name: String, symbol: String, base_uri: String);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Transfer an NFT item from current owner to the new one</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fn transfer(&amp;mut self, rom: &amp;ActorId, to: &amp;ActorId, token_id: U256);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Gives a right to the actor to manage the specific token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fn approve(&amp;mut self, owner: &amp;ActorId, spender: &amp;ActorId, token_id: U256);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// Enables or disables the actor to manage all the tokens the owner has</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fn approve_for_all(&amp;mut self, owner: &amp;ActorId, operator: &amp;ActorId, approved: bool);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Functions above are essential for an NFT implementation and are implemented in the interface provided by Gear.</p><p>The core component of the ERC-721 interface library is the <code>NonFungibleToken</code> struct. It contains implementations for the functions defined in the <code>NonFungibleTokenBase</code> trait and some useful helper functions such as <code>authorized_actor</code>, <code>is_token_owner</code>, etc.</p><p>Gear&#x27;s ERC-721 interface is a library that can be used as a core block in writing a smart contract for an NFT implementation. Let&#x27;s take a look at how this interface can be composed into a complete contract.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="nft-example">NFT example<a class="hash-link" href="#nft-example" title="Direct link to heading">â€‹</a></h2><p>In this section, we will be referring to <a href="https://github.com/gear-tech/apps/tree/master/nft-example" target="_blank" rel="noopener noreferrer">this</a> implementation example of an NFT smart contract provided by Gear.</p><p>First of all, the actions accepted by the contract should be in accordance with ERC-721:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub enum Action {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Mint,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Burn(U256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Transfer(TransferInput),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Approve(ApproveInput),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ApproveForAll(ApproveForAllInput),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    OwnerOf(U256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    BalanceOf(H256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The state querying methods complete the interface compliance:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub enum State {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    BalanceOfUser(H256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TokenOwner(U256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    IsTokenOwner(TokenAndUser),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GetApproved(U256),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Gear&#x27;s ERC-721 library contains full implementations for <code>transfer</code>, <code>approve</code> and <code>approve_for_all</code> actions. Let&#x27;s take advantage of those by importing the library and storing it in the state of the contract.</p><p>Keep in mind, that the library also contains multiple useful structs such as <code>Approve</code>, <code>ApproveForAll</code> and <code>Transfer</code> that can be reused for a custom implementation.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub struct NFT {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub tokens: NonFungibleToken,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub token_id: U256,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub owner: ActorId,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Note how <code>NonFungibleToken</code> struct from the ERC-721 library is composed inside the state; that allows to reuse the functionality it provides within the implementation of the contract&#x27;s methods.</p><p>We will also need custom implementation for the <code>mint</code> and <code>burn</code> methods as mentioned above.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">impl NFT {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fn mint(&amp;mut self) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      // custom mint implementation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fn burn(&amp;mut self, token_id: U256) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      // custom burn implementation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now, inside the <code>handle</code> method, we can use <code>mint</code> and <code>burn</code> described above for <code>Mint</code> and <code>Burn</code> actions. For the rest of the actions (i.e. <code>Approve</code>, <code>ApproveForAll</code>, <code>Transfer</code>, <code>OwnerOf</code> and <code>BalanceOf</code>), we can reuse Gear&#x27;s ERC-721 library implementations.</p><p>Same goes for state querying, i.e. the <code>metastate</code> method: library functions can be reused for query implementations.</p><p>For example, the <code>Mint</code> action can be implemented simply as:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Action::Mint =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CONTRACT.mint();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Similarly, take a look at <code>Approve</code> that takes advantage of the provided interface:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Action::Approve(input) =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CONTRACT.tokens.approve(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &amp;msg::source(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &amp;ActorId::new(input.to.to_fixed_bytes()),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        input.token_id,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>Gear provides a reusable <a href="https://github.com/gear-tech/apps/tree/master/non-fungible-token/src" target="_blank" rel="noopener noreferrer">library</a> with core functionality for the ERC-721 protocol. By using object composition, that library can be utilized within a custom NFT contract implementation in order to minimize duplication of community available code.</p><p>A source code of the contract example provided by Gear is available on GitHub: <a href="https://github.com/gear-tech/apps/tree/master/nft-example/src" target="_blank" rel="noopener noreferrer">nft-example/src</a>.</p><p>See also an example of the smart contract testing implementation based on <code>gtest</code>: <a href="https://github.com/gear-tech/apps/tree/master/nft-example/tests" target="_blank" rel="noopener noreferrer">nft-example/tests</a>.</p><p>For more details about testing smart contracts written on Gear, refer to this article: <a href="/developing-contracts/testing">Program testing</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gear-tech/wiki/edit/master/docs/developing-contracts/examples/erc-721.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/developing-contracts/examples/ping"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">PING-PONG</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/developing-contracts/examples/erc20"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ERC-20</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#erc-721-interface" class="table-of-contents__link toc-highlight">ERC-721 interface</a></li><li><a href="#nft-example" class="table-of-contents__link toc-highlight">NFT example</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.104e92f9.js"></script>
<script src="/assets/js/main.01f51f45.js"></script>
</body>
</html>